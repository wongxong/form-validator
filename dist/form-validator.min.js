!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,(function(){return function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t){return t=t||document,e instanceof Node?e:t.querySelector(e)}function i(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.r(t),e.d(t,{Validator:function(){return o}});var o=function(){function e(t,r,i){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elForm=n(t),!this.elForm)throw Error("elForm must be an form Element.");this.options=Object.assign({preventSubmit:!0,errorClass:"form-item__error",errorParentClass:"form-item__content"},i),this.fields={},this.rules={},this.__handlers=[],!1!==this.options.preventSubmit&&this.__handlers.push({el:this.elForm,type:"submit",handler:function(e){e.preventDefault()}}),this.addRules(r),this.addListeners()}var t,o;return t=e,(o=[{key:"addListeners",value:function(){this.__handlers.forEach((function(e){var t=e.el,r=e.type,n=e.handler;t.addEventListener(r,n,!1)}))}},{key:"removeListeners",value:function(){this.__handlers.forEach((function(e){var t=e.el,r=e.type,n=e.handler;t.removeEventListener(r,n,!1)})),this.__handlers=[]}},{key:"destroy",value:function(){this.removeListeners(),this.rules={},this.fields={}}},{key:"isRequired",value:function(e){return!!this.rules[e]&&this.rules[e].some((function(e){return e.required}))}},{key:"addRules",value:function(e){var t=this;e&&Object.keys(e).forEach((function(r){t.rules[r]?t.rules[r]=t.rules[r].concat(e[r]):t.rules[r]=e[r],t.addField(r)}))}},{key:"addField",value:function(e){if(!this.fields[e]){var t=n('[data-prop="'+e+'"]',this.elForm);if(!t)return;var r,i=n('[data-field="'+e+'"]',t);if(!i)return;this.isRequired(e)&&t.classList.add("is-required"),(r=i.getAttribute("data-trigger"))?this.__handlers.push({el:i,type:r,handler:this.validate.bind(this,e)}):"TEXTAREA"===i.nodeName||"INPUT"===i.nodeName&&!["radio","checkbox"].includes(i.type)?this.__handlers.push({el:i,type:"blur",handler:this.validate.bind(this,e,null)}):this.__handlers.push({el:i,type:"change",handler:this.validate.bind(this,e,null)}),this.fields[e]={el:t,fieldEl:i}}}},{key:"validate",value:function(e,t){var r=this;if("string"===i(e))this.validateField(e,t);else{var n;"array"===i(e)?n=e:(n=Object.keys(this.fields),t=e,e=null);var s=0,o=!0;n.forEach((function(e){r.validateField(e,(function(e){s++,e||(o=!1),s>=n.length&&t&&t(o)}))}))}}},{key:"validateField",value:function(e,t){if(e&&this.fields[e]){var n,s=function(e){var t;if("SELECT"===e.nodeName)if(e.multiple){t=[];var n,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(e.selectedOptions);try{for(i.s();!(n=i.n()).done;){var s=n.value;t.push(s.value)}}catch(e){i.e(e)}finally{i.f()}}else t=e.selectedOptions[0].value;else t=e.value;return t}(this.fields[e].fieldEl),o=!1;this.rules[e].some((function(e){var t;return e.validator?e.validator(e,s,(function(t){t&&t instanceof Error&&(o=!0,e.message||(e.message=t.message))})):e.required?o=""===s:e.type&&(o="number"===e.type?!(""!==(t=s)&&!isNaN(parseFloat(t))&&isFinite(t)):i(s)!==e.type),n=e,o})),o?this.showErrorMsg(e,n.message):this.hideErrorMsg(e),t&&t(!o)}}},{key:"clearValidate",value:function(e){var t,r=this;e?"array"===i(e)?(t=e,e=null):t=[e]:t=Object.keys(this.fields),t.forEach((function(e){e&&r.fields[e]&&r.hideErrorMsg(e)}))}},{key:"showErrorMsg",value:function(e,t){if(e&&this.fields[e]){var r=this.fields[e],i=r.el,s=r.fieldEl,o=n("."+this.options.errorClass,i);o||((o=document.createElement("p")).classList.add(this.options.errorClass),n("."+this.options.errorParentClass,i).appendChild(o)),o.textContent=t,i.classList.add("is-error"),s.classList.add("is-error")}}},{key:"hideErrorMsg",value:function(e){if(e&&this.fields[e]){var t=this.fields[e],r=t.el,i=t.fieldEl,s=n("."+this.options.errorClass,r);s&&s.parentNode.removeChild(s),r.classList.remove("is-error"),i.classList.remove("is-error")}}}])&&s(t.prototype,o),e}();return t}()}));